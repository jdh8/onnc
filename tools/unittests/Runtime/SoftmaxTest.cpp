#include "dragonite.hpp"
SKYPAT_F(Operator_Softmax, test_softmax_example) {
  const float input_0[] = {-1.0, 0.0, 1.0};
  const int32_t input_0_ndim = 2;
  const int32_t input_0_dims[] = {1, 3};
  float output_0[3];
  const int32_t output_0_ndim = 2;
  const int32_t output_0_dims[] = {1, 3};
  const float answer_0[] = {0.09003058, 0.24472848, 0.66524094};
  const int32_t axis = 0;
  ONNC_RUNTIME_softmax_float(NULL, (float *)input_0, input_0_ndim, input_0_dims,
                             (float *)output_0, output_0_ndim, output_0_dims,
                             axis);
  (dragonite::verify)(reinterpret_cast<float *>(output_0),
                      reinterpret_cast<const float *>(answer_0), 3);
}

SKYPAT_F(Operator_Softmax, test_softmax_large_number) {
  const float input_0[] = {0.0,     1.0,     2.0,     3.0,
                           10000.0, 10001.0, 10002.0, 10003.0};
  const int32_t input_0_ndim = 2;
  const int32_t input_0_dims[] = {2, 4};
  float output_0[8];
  const int32_t output_0_ndim = 2;
  const int32_t output_0_dims[] = {2, 4};
  const float answer_0[] = {0.032058604, 0.08714432, 0.23688284, 0.6439143,
                            0.032058604, 0.08714432, 0.23688284, 0.6439143};
  const int32_t axis = 0;
  ONNC_RUNTIME_softmax_float(NULL, (float *)input_0, input_0_ndim, input_0_dims,
                             (float *)output_0, output_0_ndim, output_0_dims,
                             axis);
  (dragonite::verify)(reinterpret_cast<float *>(output_0),
                      reinterpret_cast<const float *>(answer_0), 8);
}

SKYPAT_F(Operator_Softmax, test_softmax_axis_0) {
  const float input_0[] = {
      0.4574685,   0.72175044, 0.04161324,    1.4968733,   0.62464064,
      1.6655204,   0.38425577, 0.7004105,     0.13597426,  0.07521779,
      1.283202,    0.31955463, 8.2235696E-05, 0.5303891,   0.45172295,
      1.7721585,   0.1262685,  1.5574117,     0.36627388,  0.3757344,
      0.120421685, 0.14883754, 2.008706,      1.29317,     0.18918483,
      0.059629563, 0.5471113,  0.36877143,    0.13887006,  0.4388167,
      0.35356447,  0.46238273, 0.5485166,     1.6333,      0.7133394,
      1.3208297,   0.26875022, 0.40621656,    1.6681812,   2.0489104,
      0.236048,    0.7077565,  0.14749941,    2.091166,    0.78984433,
      0.38358834,  0.31163484, 1.1662812,     0.119980514, 0.36817014,
      0.7920539,   0.17557158, 0.75112057,    0.51297635,  0.6297889,
      1.1645396,   1.6881859,  0.15074295,    0.6085662,   0.022073943};
  const int32_t input_0_ndim = 3;
  const int32_t input_0_dims[] = {3, 4, 5};
  float output_0[60];
  const int32_t output_0_ndim = 3;
  const int32_t output_0_dims[] = {3, 4, 5};
  const float answer_0[] = {
      0.010968636,  0.014286599,  0.007236841,  0.031014184, 0.012964465,
      0.036711566,  0.010194284,  0.013984952,  0.007952972, 0.007484162,
      0.025047485,  0.009555587,  0.0069424426, 0.011798359, 0.010905797,
      0.04084277,   0.007876155,  0.03294973,   0.01001261,  0.010107783,
      0.007830239,  0.008055935,  0.051742397,  0.025298405, 0.008387615,
      0.0073684035, 0.011997312,  0.0100376485, 0.007976035, 0.010765947,
      0.0098861605, 0.011022672,  0.012014184,  0.035547554, 0.014166936,
      0.026007922,  0.0090822475, 0.010420635,  0.036809374, 0.053865045,
      0.008790041,  0.014088064,  0.008045162,  0.056189924, 0.015293314,
      0.010187482,  0.009480207,  0.022283636,  0.007826786, 0.010031614,
      0.015327144,  0.008274206,  0.014712418,  0.011594697, 0.013031379,
      0.022244861,  0.037553154,  0.008071299,  0.012757734, 0.0070968103};
  const int32_t axis = 0;
  ONNC_RUNTIME_softmax_float(NULL, (float *)input_0, input_0_ndim, input_0_dims,
                             (float *)output_0, output_0_ndim, output_0_dims,
                             axis);
  (dragonite::verify)(reinterpret_cast<float *>(output_0),
                      reinterpret_cast<const float *>(answer_0), 60);
}

SKYPAT_F(Operator_Softmax, test_softmax_axis_1) {
  const float input_0[] = {
      0.4574685,   0.72175044, 0.04161324,    1.4968733,   0.62464064,
      1.6655204,   0.38425577, 0.7004105,     0.13597426,  0.07521779,
      1.283202,    0.31955463, 8.2235696E-05, 0.5303891,   0.45172295,
      1.7721585,   0.1262685,  1.5574117,     0.36627388,  0.3757344,
      0.120421685, 0.14883754, 2.008706,      1.29317,     0.18918483,
      0.059629563, 0.5471113,  0.36877143,    0.13887006,  0.4388167,
      0.35356447,  0.46238273, 0.5485166,     1.6333,      0.7133394,
      1.3208297,   0.26875022, 0.40621656,    1.6681812,   2.0489104,
      0.236048,    0.7077565,  0.14749941,    2.091166,    0.78984433,
      0.38358834,  0.31163484, 1.1662812,     0.119980514, 0.36817014,
      0.7920539,   0.17557158, 0.75112057,    0.51297635,  0.6297889,
      1.1645396,   1.6881859,  0.15074295,    0.6085662,   0.022073943};
  const int32_t input_0_ndim = 3;
  const int32_t input_0_dims[] = {3, 4, 5};
  float output_0[60];
  const int32_t output_0_ndim = 3;
  const int32_t output_0_dims[] = {3, 4, 5};
  const float answer_0[] = {
      0.03440198,  0.04480841,  0.02269759,  0.09727274,  0.040661678,
      0.11514197,  0.031973302, 0.043862335, 0.024943663, 0.023473294,
      0.07855882,  0.029970098, 0.021774244, 0.037004318, 0.034204885,
      0.12809908,  0.024702735, 0.103343375, 0.0314035,   0.031702004,
      0.021261493, 0.021874323, 0.14049642,  0.06869291,  0.022774937,
      0.020007465, 0.03257637,  0.027255282, 0.021657372, 0.029232837,
      0.02684395,  0.029929921, 0.03262218,  0.09652247,  0.03846756,
      0.07061946,  0.024661077, 0.028295211, 0.099948704, 0.14626007,
      0.028093973, 0.04502706,  0.025713254, 0.1795894,   0.048879176,
      0.032560356, 0.030299824, 0.07122104,  0.0250153,   0.032062184,
      0.0489873,   0.026445307, 0.047022566, 0.037057973, 0.041649774,
      0.07109711,  0.12002416,  0.025796792, 0.040775172, 0.022682214};
  const int32_t axis = 1;
  ONNC_RUNTIME_softmax_float(NULL, (float *)input_0, input_0_ndim, input_0_dims,
                             (float *)output_0, output_0_ndim, output_0_dims,
                             axis);
  (dragonite::verify)(reinterpret_cast<float *>(output_0),
                      reinterpret_cast<const float *>(answer_0), 60);
}

SKYPAT_F(Operator_Softmax, test_softmax_default_axis) {
  const float input_0[] = {
      0.4574685,   0.72175044, 0.04161324,    1.4968733,   0.62464064,
      1.6655204,   0.38425577, 0.7004105,     0.13597426,  0.07521779,
      1.283202,    0.31955463, 8.2235696E-05, 0.5303891,   0.45172295,
      1.7721585,   0.1262685,  1.5574117,     0.36627388,  0.3757344,
      0.120421685, 0.14883754, 2.008706,      1.29317,     0.18918483,
      0.059629563, 0.5471113,  0.36877143,    0.13887006,  0.4388167,
      0.35356447,  0.46238273, 0.5485166,     1.6333,      0.7133394,
      1.3208297,   0.26875022, 0.40621656,    1.6681812,   2.0489104,
      0.236048,    0.7077565,  0.14749941,    2.091166,    0.78984433,
      0.38358834,  0.31163484, 1.1662812,     0.119980514, 0.36817014,
      0.7920539,   0.17557158, 0.75112057,    0.51297635,  0.6297889,
      1.1645396,   1.6881859,  0.15074295,    0.6085662,   0.022073943};
  const int32_t input_0_ndim = 3;
  const int32_t input_0_dims[] = {3, 4, 5};
  float output_0[60];
  const int32_t output_0_ndim = 3;
  const int32_t output_0_dims[] = {3, 4, 5};
  const float answer_0[] = {
      0.03440198,  0.04480841,  0.02269759,  0.09727274,  0.040661678,
      0.11514197,  0.031973302, 0.043862335, 0.024943663, 0.023473294,
      0.07855882,  0.029970098, 0.021774244, 0.037004318, 0.034204885,
      0.12809908,  0.024702735, 0.103343375, 0.0314035,   0.031702004,
      0.021261493, 0.021874323, 0.14049642,  0.06869291,  0.022774937,
      0.020007465, 0.03257637,  0.027255282, 0.021657372, 0.029232837,
      0.02684395,  0.029929921, 0.03262218,  0.09652247,  0.03846756,
      0.07061946,  0.024661077, 0.028295211, 0.099948704, 0.14626007,
      0.028093973, 0.04502706,  0.025713254, 0.1795894,   0.048879176,
      0.032560356, 0.030299824, 0.07122104,  0.0250153,   0.032062184,
      0.0489873,   0.026445307, 0.047022566, 0.037057973, 0.041649774,
      0.07109711,  0.12002416,  0.025796792, 0.040775172, 0.022682214};
  const int32_t axis = 0;
  ONNC_RUNTIME_softmax_float(NULL, (float *)input_0, input_0_ndim, input_0_dims,
                             (float *)output_0, output_0_ndim, output_0_dims,
                             axis);
  (dragonite::verify)(reinterpret_cast<float *>(output_0),
                      reinterpret_cast<const float *>(answer_0), 60);
}

SKYPAT_F(Operator_Softmax, test_softmax_axis_2) {
  const float input_0[] = {
      0.4574685,   0.72175044, 0.04161324,    1.4968733,   0.62464064,
      1.6655204,   0.38425577, 0.7004105,     0.13597426,  0.07521779,
      1.283202,    0.31955463, 8.2235696E-05, 0.5303891,   0.45172295,
      1.7721585,   0.1262685,  1.5574117,     0.36627388,  0.3757344,
      0.120421685, 0.14883754, 2.008706,      1.29317,     0.18918483,
      0.059629563, 0.5471113,  0.36877143,    0.13887006,  0.4388167,
      0.35356447,  0.46238273, 0.5485166,     1.6333,      0.7133394,
      1.3208297,   0.26875022, 0.40621656,    1.6681812,   2.0489104,
      0.236048,    0.7077565,  0.14749941,    2.091166,    0.78984433,
      0.38358834,  0.31163484, 1.1662812,     0.119980514, 0.36817014,
      0.7920539,   0.17557158, 0.75112057,    0.51297635,  0.6297889,
      1.1645396,   1.6881859,  0.15074295,    0.6085662,   0.022073943};
  const int32_t input_0_ndim = 3;
  const int32_t input_0_dims[] = {3, 4, 5};
  float output_0[60];
  const int32_t output_0_ndim = 3;
  const int32_t output_0_dims[] = {3, 4, 5};
  const float answer_0[] = {
      0.14343576,  0.18682441, 0.09463544,  0.4055694,   0.16953501,
      0.48097157,  0.13355903, 0.18322194,  0.104194775, 0.09805275,
      0.38984615,  0.14872585, 0.10805413,  0.183633,    0.16974089,
      0.40124917,  0.07737723, 0.323706,    0.09836627,  0.099301286,
      0.07728639,  0.07951406, 0.51071024,  0.24970151,  0.08278783,
      0.15304495,  0.24918945, 0.20848636,  0.16566576,  0.22361344,
      0.119632855, 0.1333858,  0.14538418,  0.4301625,   0.1714347,
      0.19097461,  0.0666904,  0.0765181,   0.27028903,  0.3955278,
      0.085834794, 0.13757002, 0.078561045, 0.54869485,  0.14933929,
      0.17033152,  0.15850613, 0.37257546,  0.13086142,  0.16772546,
      0.24352053,  0.13146214, 0.23375368,  0.1842187,   0.207045,
      0.25357822,  0.4280837,  0.092008024, 0.14543061,  0.080899425};
  const int32_t axis = 2;
  ONNC_RUNTIME_softmax_float(NULL, (float *)input_0, input_0_ndim, input_0_dims,
                             (float *)output_0, output_0_ndim, output_0_dims,
                             axis);
  (dragonite::verify)(reinterpret_cast<float *>(output_0),
                      reinterpret_cast<const float *>(answer_0), 60);
}
