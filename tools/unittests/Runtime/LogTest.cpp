#if defined(__GNUC__) || defined(_MSC_VER)
#define restrict __restrict
#else
#define restrict
#endif

extern "C" {
#include <onnc/Runtime/onnc-runtime.h>
}

#undef restrict

#include "relative-error.hpp"
#include <skypat/skypat.h>
SKYPAT_F(Operator_Log, test_log_example) {
  const float input_0[] = {1.0, 10.0};
  const int32_t input_0_ndim = 1;
  const int32_t input_0_dims[] = {2};
  float output_0[2];
  const int32_t output_0_ndim = 1;
  const int32_t output_0_dims[] = {2};
  const float answer_0[] = {0.0, 2.3025851};
  ONNC_RUNTIME_log_float(nullptr, input_0, input_0_ndim, input_0_dims, output_0,
                         output_0_ndim, output_0_dims);
  ASSERT_TRUE(relative_error(output_0, answer_0, 2) < 1e-5f);
}

SKYPAT_F(Operator_Log, test_log) {
  const float input_0[] = {
      0.059787188, 0.066131696, 1.640928,   0.65942013, 5.394727,   0.64330554,
      0.30479175,  5.1737947,   4.0217686,  0.9233041,  0.39662334, 0.23741104,
      0.6372757,   3.2620053,   1.0798672,  0.51007265, 1.6228575,  0.22735794,
      1.076463,    0.2323272,   0.628381,   0.11701639, 4.193871,   0.7671928,
      0.90525556,  3.06294,     0.2164259,  0.24526216, 2.0890937,  0.69543606,
      0.9434622,   3.519302,    1.0245882,  0.3803552,  1.0855339,  1.8117087,
      0.20115478,  1.8962125,   0.54331607, 0.7719665,  0.35587043, 2.5599482,
      0.7326419,   0.8283151,   0.71786666, 0.73310256, 0.13453044, 0.5681443,
      0.6598456,   1.0220226,   0.5192048,  1.6412414,  4.1533666,  0.91881496,
      0.12826781,  0.62338805,  2.6086142,  1.4176291,  1.2560956,  0.17581919};
  const int32_t input_0_ndim = 3;
  const int32_t input_0_dims[] = {3, 4, 5};
  float output_0[60];
  const int32_t output_0_ndim = 3;
  const int32_t output_0_dims[] = {3, 4, 5};
  const float answer_0[] = {
      -2.816964,    -2.7161071, 0.49526197,  -0.4163944,  1.6854221,
      -0.4411355,   -1.1881266, 1.6436064,   1.3917217,   -0.07979665,
      -0.9247682,   -1.4379623, -0.4505529,  1.1823422,   0.07683811,
      -0.6732021,   0.48418847, -1.4812297,  0.073680654, -1.4596086,
      -0.46460858,  -2.1454413, 1.4336241,   -0.26501715, -0.09953799,
      1.1193752,    -1.5305071, -1.4054276,  0.73673034,  -0.3632162,
      -0.058198985, 1.2582626,  0.024290802, -0.9666497,  0.0820719,
      0.5942704,    -1.6036806, 0.6398584,   -0.610064,   -0.2588141,
      -1.0331886,   0.939987,   -0.31109828, -0.18836166, -0.33147144,
      -0.31046966,  -2.0059648, -0.5653798,  -0.41574943, 0.02178361,
      -0.6554569,   0.49545294, 1.4239192,   -0.08467053, -2.053635,
      -0.47258607,  0.95881915, 0.34898585,  0.22800821,  -1.7382991};
  ONNC_RUNTIME_log_float(nullptr, input_0, input_0_ndim, input_0_dims, output_0,
                         output_0_ndim, output_0_dims);
  ASSERT_TRUE(relative_error(output_0, answer_0, 60) < 1e-5f);
}
