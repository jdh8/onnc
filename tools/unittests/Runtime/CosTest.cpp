#if defined(__GNUC__) || defined(_MSC_VER)
#define restrict __restrict
#else
#define restrict
#endif

extern "C" {
#include <onnc/Runtime/onnc-runtime.h>
}

#undef restrict

#include "relative-error.hpp"
#include <skypat/skypat.h>
SKYPAT_F(Operator_Cos, test_cos_example) {
  const float input_0[] = {-1.0, 0.0, 1.0};
  const int32_t input_0_ndim = 1;
  const int32_t input_0_dims[] = {3};
  float output_0[3];
  const int32_t output_0_ndim = 1;
  const int32_t output_0_dims[] = {3};
  const float answer_0[] = {0.5403023, 1.0, 0.5403023};
  ONNC_RUNTIME_cos_float(nullptr, input_0, input_0_ndim, input_0_dims, output_0,
                         output_0_ndim, output_0_dims);
  ASSERT_TRUE(relative_error(output_0, answer_0, 3) < 1e-5f);
}

SKYPAT_F(Operator_Cos, test_cos) {
  const float input_0[] = {
      -1.4815339,  -0.36118883,  -0.02978751, 1.8734413,    -0.32665026,
      0.4406685,   -0.356416,    1.2260432,   1.5041364,    -0.033577826,
      -1.2531561,  1.1036716,    -1.3113816,  0.54091567,   1.0953271,
      0.22639701,  2.7221935,    0.8191462,   -1.0247675,   -0.15589362,
      -1.0170718,  0.3179082,    -0.44660106, -0.29586446,  -0.17407766,
      1.6244584,   0.0029668296, -0.264796,   0.5787518,    -0.19273837,
      -0.22635335, 1.0399855,    2.2530444,   -0.4879583,   1.0243304,
      -0.12552336, 0.051453218,  -0.41587862, -0.6437894,   0.7616807,
      0.12163075,  1.377576,     -0.0979451,  -0.6077989,   0.42630652,
      -0.14221148, -1.5830686,   0.09408119,  0.9008666,    -0.57742417,
      0.44861645,  -0.870744,    1.2181147,   -0.44340566,  1.1841663,
      0.25958723,  1.5364894,    0.42565843,  -0.061119176, 0.6277349};
  const int32_t input_0_ndim = 3;
  const int32_t input_0_dims[] = {3, 4, 5};
  float output_0[60];
  const int32_t output_0_ndim = 3;
  const int32_t output_0_dims[] = {3, 4, 5};
  const float answer_0[] = {
      0.089143954,  0.9354774,    0.99955636, -0.29804605, 0.9471225,
      0.90446675,   0.93715334,   0.33796433, 0.06661053,  0.9994363,
      0.31232575,   0.45032096,   0.25651494, 0.8572375,   0.45775566,
      0.97448146,   -0.9133338,   0.6828452,  0.5192976,   0.9878732,
      0.5258588,    0.9498913,    0.9019203,  0.9565505,   0.9848867,
      -0.053636353, 0.9999956,    0.9651459,  0.83714604,  0.9814834,
      0.9744913,    0.50623274,   -0.6305395, 0.8832919,   0.5196711,
      0.9921323,    0.9986766,    0.9147617,  0.799827,    0.7236771,
      0.9926121,    0.1920203,    0.9952072,  0.820907,    0.9104993,
      0.989905,     -0.012271974, 0.99557763, 0.6209309,   0.8378715,
      0.90104806,   0.6442577,    0.3454156,  0.9032958,   0.37706932,
      0.966496,     0.03430023,   0.9107671,  0.9981328,   0.8093599};
  ONNC_RUNTIME_cos_float(nullptr, input_0, input_0_ndim, input_0_dims, output_0,
                         output_0_ndim, output_0_dims);
  ASSERT_TRUE(relative_error(output_0, answer_0, 60) < 1e-5f);
}
