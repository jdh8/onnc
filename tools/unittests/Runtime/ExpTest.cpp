#if defined(__GNUC__) || defined(_MSC_VER)
#define restrict __restrict
#else
#define restrict
#endif

extern "C" {
#include <onnc/Runtime/onnc-runtime.h>
}

#undef restrict

#include "relative-error.hpp"
#include <skypat/skypat.h>
SKYPAT_F(Operator_Exp, test_exp_example) {
  const float input_0[] = {-1.0, 0.0, 1.0};
  const int32_t input_0_ndim = 1;
  const int32_t input_0_dims[] = {3};
  float output_0[3];
  const int32_t output_0_ndim = 1;
  const int32_t output_0_dims[] = {3};
  const float answer_0[] = {0.36787945, 1.0, 2.7182817};
  ONNC_RUNTIME_exp_float(nullptr, input_0, input_0_ndim, input_0_dims, output_0,
                         output_0_ndim, output_0_dims);
  ASSERT_TRUE(relative_error(output_0, answer_0, 3) < 1e-5f);
}

SKYPAT_F(Operator_Exp, test_exp) {
  const float input_0[] = {
      0.74206257,  0.027257562, -0.550883,   -1.7927879,   -2.386538,
      0.033158854, 0.22040507,  0.15438776,  1.0101737,    1.6738405,
      -1.3588163,  0.9555178,   -0.5465997,  -0.071561806, 0.24607831,
      0.31652552,  -0.8503002,  0.64233834,  0.052662857,  -0.9312579,
      0.5699299,   -0.07171286, 0.72065306,  -1.4650642,   0.26708338,
      0.31338513,  -1.3257885,  -1.2925954,  -0.110602796, -1.3786958,
      0.2559488,   -1.5108202,  0.08888803,  -0.3850413,   0.45916227,
      -0.705784,   -0.7481122,  0.8724063,   0.7028637,    0.39310846,
      -0.12945019, -0.9003218,  -0.5714615,  2.4592628,    1.488828,
      0.21230945,  0.94916683,  -0.5912464,  0.79517615,   -0.20128311,
      -1.1259152,  -1.6976817,  -0.7682016,  1.0219767,    -1.7472447,
      -1.0656893,  -0.3053255,  -0.67508227, -0.3647161,   0.14284101};
  const int32_t input_0_ndim = 3;
  const int32_t input_0_dims[] = {3, 4, 5};
  float output_0[60];
  const int32_t output_0_ndim = 3;
  const int32_t output_0_dims[] = {3, 4, 5};
  const float answer_0[] = {
      2.1002629,  1.0276325,  0.5764406,  0.16649535, 0.09194745, 1.0337148,
      1.2465816,  1.1669433,  2.746078,   5.3326087,  0.25696477, 2.6000166,
      0.57891494, 0.9309387,  1.2789997,  1.3723513,  0.42728665, 1.9009206,
      1.0540742,  0.39405772, 1.768143,   0.9307981,  2.0557754,  0.23106316,
      1.3061494,  1.3680483,  0.26559347, 0.27455726, 0.8952943,  0.25190687,
      1.2916867,  0.22072887, 1.0929582,  0.68042254, 1.5827475,  0.49372134,
      0.47325912, 2.3926613,  2.0195277,  1.4815791,  0.87857836, 0.40643886,
      0.56469953, 11.696186,  4.431898,   1.2365304,  2.5835562,  0.5536368,
      2.214831,   0.8176809,  0.32435548, 0.18310754, 0.4638465,  2.778682,
      0.1742534,  0.34449032, 0.73688346, 0.50911456, 0.69439375, 1.1535463};
  ONNC_RUNTIME_exp_float(nullptr, input_0, input_0_ndim, input_0_dims, output_0,
                         output_0_ndim, output_0_dims);
  ASSERT_TRUE(relative_error(output_0, answer_0, 60) < 1e-5f);
}
