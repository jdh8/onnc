#if defined(__GNUC__) || defined(_MSC_VER)
#define restrict __restrict
#else
#define restrict
#endif

extern "C" {
#include <onnc/Runtime/onnc-runtime.h>
}

#undef restrict

#include "relative-error.hpp"
#include <skypat/skypat.h>
SKYPAT_F(Operator_Relu, test_relu) {
  const float input_0[] = {
      0.7610377,   0.121675014, 0.44386324,   0.33367434,  1.4940791,
      -0.20515826, 0.3130677,   -0.85409576,  -2.5529897,  0.6536186,
      0.8644362,   -0.742165,   2.2697546,    -1.4543657,  0.045758516,
      -0.18718386, 1.5327792,   1.4693588,    0.15494743,  0.37816253,
      -0.88778573, -1.9807965,  -0.34791216,  0.15634897,  1.2302907,
      1.2023798,   -0.3873268,  -0.30230275,  -1.048553,   -1.420018,
      -1.7062702,  1.9507754,   -0.5096522,   -0.4380743,  -1.2527953,
      0.7774904,   -1.6138978,  -0.21274029,  -0.89546657, 0.3869025,
      -0.51080513, -1.1806322,  -0.028182229, 0.42833188,  0.06651722,
      0.3024719,   -0.6343221,  -0.36274117,  -0.67246044, -0.35955316,
      -0.8131463,  -1.7262826,  0.17742614,   -0.40178093, -1.6301984,
      0.46278226,  -0.9072984,  0.051945396,  0.7290906,   0.12898292};
  const int32_t input_0_ndim = 3;
  const int32_t input_0_dims[] = {3, 4, 5};
  float output_0[60];
  const int32_t output_0_ndim = 3;
  const int32_t output_0_dims[] = {3, 4, 5};
  const float answer_0[] = {
      0.7610377,  0.121675014, 0.44386324,  0.33367434, 1.4940791,
      0.0,        0.3130677,   0.0,         0.0,        0.6536186,
      0.8644362,  0.0,         2.2697546,   0.0,        0.045758516,
      0.0,        1.5327792,   1.4693588,   0.15494743, 0.37816253,
      0.0,        0.0,         0.0,         0.15634897, 1.2302907,
      1.2023798,  0.0,         0.0,         0.0,        0.0,
      0.0,        1.9507754,   0.0,         0.0,        0.0,
      0.7774904,  0.0,         0.0,         0.0,        0.3869025,
      0.0,        0.0,         0.0,         0.42833188, 0.06651722,
      0.3024719,  0.0,         0.0,         0.0,        0.0,
      0.0,        0.0,         0.17742614,  0.0,        0.0,
      0.46278226, 0.0,         0.051945396, 0.7290906,  0.12898292};
  ONNC_RUNTIME_relu_float(nullptr, input_0, input_0_ndim, input_0_dims,
                          output_0, output_0_ndim, output_0_dims);
  ASSERT_TRUE(relative_error(output_0, answer_0, 60) < 1e-5f);
}
