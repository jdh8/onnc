#include "dragonite.hpp"
SKYPAT_F(Operator_Add, test_add) {
  const float input_0[] = {
      -0.12958944, 0.063409075,  -0.48565647, -0.31393832, 0.45459804,
      1.0362966,   -0.15193842,  -0.15130544, -0.23283671, 1.4515572,
      -1.0114812,  -1.96393,     -2.7341208,  -0.93070775, -0.10477639,
      -0.9408753,  -1.200598,    -2.0684438,  1.1227244,   -1.6447849,
      0.12300709,  1.2299833,    -1.8824321,  0.6165122,   -1.58385,
      0.015416728, 0.82876796,   0.49263835,  0.64202994,  -1.2276555,
      0.021184059, 0.13245298,   1.1751318,   0.6432191,   -0.42073426,
      -1.2559367,  0.11729731,   0.025136761, -0.56202555, -0.48039418,
      0.5907255,   0.5635386,    0.08397937,  1.1224788,   0.6316525,
      2.4297469,   -0.5991243,   -1.6323597,  1.2444081,   -2.9326766,
      -1.4103843,  -0.01667235,  -1.1670707,  -1.2265635,  0.94430095,
      -0.926434,   -0.024093747, 0.06730185,  0.5269,      -0.20072041};
  const int32_t input_0_ndim = 3;
  const int32_t input_0_dims[] = {3, 4, 5};
  const float input_1[] = {
      -1.0450019,  1.1141331,   -1.0932401, 0.32818836,  0.997885,
      -0.2673594,  -0.15710351, 0.5649517,  0.49225897,  0.4728203,
      -0.4057917,  -0.49293476, -1.5472066, -0.90407395, 1.0319526,
      0.005162303, 0.34204364,  0.37964764, 0.43167967,  -0.5610145,
      -0.18570486, 1.1322035,   0.49429327, -1.0209804,  -0.4586329,
      -0.22106923, -2.1479683,  1.9338058,  0.5972405,   -0.5278931,
      -1.0953891,  0.41435784,  -1.7706777, 0.31403548,  1.5270084,
      -1.5295666,  -1.0274425,  -0.7201621, 0.0632874,   0.8299994,
      0.06270753,  -1.7195946,  1.5665394,  0.5506601,   1.560125,
      -0.60325867, 0.2764871,   0.46057683, 0.76129115,  -0.43171474,
      1.137926,    -1.1155263,  -1.1832545, 0.9648629,   0.757667,
      -0.33942854, -0.1888281,  1.8329523,  -0.8903344,  0.60850674};
  const int32_t input_1_ndim = 3;
  const int32_t input_1_dims[] = {3, 4, 5};
  float output_0[60];
  const int32_t output_0_ndim = 3;
  const int32_t output_0_dims[] = {3, 4, 5};
  const float answer_0[] = {
      -1.1745913,  1.1775422,   -1.5788966, 0.01425004,  1.452483,
      0.76893723,  -0.30904192, 0.41364628, 0.25942224,  1.9243774,
      -1.4172728,  -2.4568648,  -4.2813272, -1.8347816,  0.92717624,
      -0.935713,   -0.85855436, -1.6887962, 1.554404,    -2.2057993,
      -0.06269777, 2.362187,    -1.3881388, -0.40446818, -2.0424829,
      -0.2056525,  -1.3192003,  2.426444,   1.2392704,   -1.7555487,
      -1.074205,   0.5468108,   -0.5955459, 0.9572546,   1.1062741,
      -2.7855034,  -0.91014516, -0.6950253, -0.49873814, 0.3496052,
      0.653433,    -1.1560559,  1.6505188,  1.6731389,   2.1917775,
      1.8264883,   -0.3226372,  -1.171783,  2.0056992,   -3.3643913,
      -0.2724583,  -1.1321987,  -2.350325,  -0.26170057, 1.701968,
      -1.2658625,  -0.21292184, 1.9002541,  -0.36343443, 0.4077863};
  ONNC_RUNTIME_add_float(NULL, (float *)input_0, input_0_ndim, input_0_dims,
                         (float *)input_1, input_1_ndim, input_1_dims,
                         (float *)output_0, output_0_ndim, output_0_dims);
  (dragonite::verify)(reinterpret_cast<float *>(output_0),
                      reinterpret_cast<const float *>(answer_0), 60);
}

SKYPAT_F(Operator_Add, test_add_bcast) {
  const float input_0[] = {
      -0.82335496,  0.86355567,   -0.38690287, -0.6399997,  -0.6339264,
      0.23985428,   0.5575328,    0.39127845,  -0.7879489,  -1.5798728,
      -1.0851804,   1.9595659,    -0.5285436,  0.7762738,   0.5335319,
      0.7184545,    0.8655249,    0.341142,    -0.22664507, 0.7776991,
      -0.13001178,  1.8155018,    -0.07115988, -0.15726215, -0.24657911,
      -0.35673878,  0.121978186,  -0.33799544, 0.602054,    -0.33248085,
      -0.32155716,  0.35894835,   -3.4045677,  -1.6004797,  -0.12946941,
      -1.6222483,   -0.045204397, 0.33592615,  -1.6788746,  -0.6134323,
      0.15647158,   1.667372,     1.5736753,   0.010529771, 1.0808578,
      0.61563665,   -1.0130597,   -0.52242756, 1.8665215,   -1.6725329,
      0.8282064,    0.64215684,   -0.6008097,  1.4238751,   -0.14562185,
      -0.019667363, 0.6390637,    -1.1367545,  -0.16778837, -0.0720669};
  const int32_t input_0_ndim = 3;
  const int32_t input_0_dims[] = {3, 4, 5};
  const float input_1[] = {-0.8317925, 0.38266203, -1.5265765, -1.2697155,
                           -1.8876272};
  const int32_t input_1_ndim = 1;
  const int32_t input_1_dims[] = {5};
  float output_0[60];
  const int32_t output_0_ndim = 3;
  const int32_t output_0_dims[] = {3, 4, 5};
  const float answer_0[] = {
      -1.6551474,    1.2462177,  -1.9134793,  -1.9097152,  -2.5215535,
      -0.5919382,    0.94019485, -1.135298,   -2.0576644,  -3.4675002,
      -1.9169729,    2.342228,   -2.05512,    -0.49344176, -1.3540953,
      -0.11333799,   1.248187,   -1.1854346,  -1.4963607,  -1.1099281,
      -0.9618043,    2.1981637,  -1.5977364,  -1.4269776,  -2.1342063,
      -1.1885313,    0.5046402,  -1.8645719,  -0.66766155, -2.220108,
      -1.1533496,    0.7416104,  -4.931144,   -2.8701954,  -2.0170968,
      -2.4540408,    0.33745763, -1.1906503,  -2.9485903,  -2.5010595,
      -0.67532086,   2.050034,   0.047098756, -1.2591858,  -0.8067695,
      -0.21615583,   -0.6303977, -2.049004,   0.59680593,  -3.5601602,
      -0.0035860538, 1.0248189,  -2.127386,   0.15415955,  -2.0332491,
      -0.85145986,   1.0217258,  -2.663331,   -1.4375039,  -1.9596941};
  ONNC_RUNTIME_add_float(NULL, (float *)input_0, input_0_ndim, input_0_dims,
                         (float *)input_1, input_1_ndim, input_1_dims,
                         (float *)output_0, output_0_ndim, output_0_dims);
  (dragonite::verify)(reinterpret_cast<float *>(output_0),
                      reinterpret_cast<const float *>(answer_0), 60);
}
