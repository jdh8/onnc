#include "dragonite.hpp"
SKYPAT_F(Operator_Mul, test_mul_example) {
  const float input_0[] = {1.0, 2.0, 3.0};
  const int32_t input_0_ndim = 1;
  const int32_t input_0_dims[] = {3};
  const float input_1[] = {4.0, 5.0, 6.0};
  const int32_t input_1_ndim = 1;
  const int32_t input_1_dims[] = {3};
  float output_0[3];
  const int32_t output_0_ndim = 1;
  const int32_t output_0_dims[] = {3};
  const float answer_0[] = {4.0, 10.0, 18.0};
  ONNC_RUNTIME_mul_float(NULL, (float *)input_0, input_0_ndim, input_0_dims,
                         (float *)input_1, input_1_ndim, input_1_dims,
                         (float *)output_0, output_0_ndim, output_0_dims);
  (dragonite::verify)(reinterpret_cast<float *>(output_0),
                      reinterpret_cast<const float *>(answer_0), 3);
}

SKYPAT_F(Operator_Mul, test_mul) {
  const float input_0[] = {
      0.41571692,  0.68479395,   -2.5890357,  1.3213307,    -0.12806237,
      -0.3933895,  -0.2797978,   0.4186293,   -0.03183501,  -0.25411564,
      -0.14984024, 0.7838965,    -0.8754969,  -0.6730048,   -0.7598754,
      -0.8502126,  1.1678431,    0.35774714,  0.0033902468, 0.12872684,
      -0.59713936, -0.080980286, -2.1924973,  -0.45837831,  1.6775862,
      1.5367258,   0.82380956,   -0.8741909,  0.23709153,   1.2786564,
      -1.9224712,  -1.1655469,   0.7697329,   1.511881,     -0.43750986,
      1.2324705,   0.50469434,   -0.27585936, -1.9425751,   0.21662165,
      -1.9640807,  0.21534961,   -1.3917686,  -0.39578214,  -0.6995719,
      -0.22853453, 0.9916744,    -1.0260022,  -0.15969744,  0.52781975,
      1.4406189,   -0.45477328,  0.2852077,   1.1524478,    -0.49274004,
      -0.9421786,  -1.8227133,   0.25571117,  -0.85623753,  1.8036393};
  const int32_t input_0_ndim = 3;
  const int32_t input_0_dims[] = {3, 4, 5};
  const float input_1[] = {
      0.063581854,  -0.42957395, -1.5075865,  -1.2042526,  0.21481608,
      -1.2379506,   0.37525517,  -0.46676958, -0.86284596, -0.31931996,
      -0.76944935,  -2.0281997,  0.3308415,   0.7632913,   1.0416918,
      0.63851666,   0.83622545,  -0.7074912,  -1.8589091,  -0.61125773,
      -0.8516977,   -0.69052154, 0.26958206,  -0.1487811,  -0.044728167,
      0.10609218,   -0.6766496,  0.8241761,   -0.39935225, -0.09015454,
      -0.5985227,   1.5905871,   -0.7215354,  -0.78840774, 0.95183516,
      -0.057559017, 1.0687573,   0.36030403,  -0.47063103, 1.5507008,
      1.4899039,    -0.47984034, 0.7224965,   -0.3883808,  1.7123413,
      1.6402512,    -0.60561335, -1.6289741,  1.5888202,   -1.103084,
      1.2714833,    0.63002896,  0.55821234,  -0.19874798, -1.5410713,
      -0.9219251,   -0.25098905, 0.37308505,  -1.6536024,  -0.23576888};
  const int32_t input_1_ndim = 3;
  const int32_t input_1_dims[] = {3, 4, 5};
  float output_0[60];
  const int32_t output_0_ndim = 3;
  const int32_t output_0_dims[] = {3, 4, 5};
  const float answer_0[] = {
      0.026432052,  -0.29416963, 3.9031954,   -1.5912158,    -0.027509855,
      0.48699674,   -0.10499557, -0.19540341, 0.027468707,   0.0811442,
      0.11529447,   -1.5898986,  -0.28965074, -0.5136987,    -0.791556,
      -0.5428749,   0.97658014,  -0.25310296, -0.0063021607, -0.078685276,
      0.50858223,   0.05591863,  -0.59105796, 0.06819803,    -0.075035356,
      0.16303459,   -0.5574304,  -0.72048724, -0.094683036,  -0.11527668,
      1.1506426,    -1.8539039,  -0.5553895,  -1.1919787,    -0.41643727,
      -0.070939794, 0.53939575,  -0.09939323, 0.9142361,     0.33591536,
      -2.9262915,   -0.10333343, -1.0055479,  0.15371418,    -1.1979059,
      -0.37485403,  -0.6005713,  1.6713309,   -0.25373054,   -0.5822295,
      1.8317229,    -0.28652033, 0.15920645,  -0.22904667,   0.7593475,
      0.86861813,   0.45748106,  0.09540202,  1.4158764,     -0.42524204};
  ONNC_RUNTIME_mul_float(NULL, (float *)input_0, input_0_ndim, input_0_dims,
                         (float *)input_1, input_1_ndim, input_1_dims,
                         (float *)output_0, output_0_ndim, output_0_dims);
  (dragonite::verify)(reinterpret_cast<float *>(output_0),
                      reinterpret_cast<const float *>(answer_0), 60);
}

SKYPAT_F(Operator_Mul, test_mul_bcast) {
  const float input_0[] = {
      0.861906,     -1.0208497,  0.6982492,   -1.0263945,  -0.73107195,
      -0.037255235, -1.0046538,  -0.98004776, 0.25006303,  -0.81701165,
      -0.24540004,  -0.9498754,  -0.9067494,  0.06688485,  -0.08947066,
      1.1679128,    -0.62174076, -0.10494644, -0.33531114, 1.3329978,
      1.169669,     0.2553844,   -2.2414868,  -0.9668708,  0.57473487,
      -0.32402864,  -0.89934456, -1.0350511,  -1.3762945,  0.7582781,
      0.5293701,    1.0971562,   -0.23885144, 0.5530921,   0.6354243,
      0.2732725,    -1.4270481,  0.8129359,   -0.32002902, 0.22660135,
      0.26013866,   1.0351322,   1.3677944,   -1.0784531,  1.1668656,
      0.7681947,    -1.6107044,  0.14839596,  -0.70435727, -0.22437726,
      0.10287291,   -0.39873254, -1.2294004,  -0.42362535, 2.3211627,
      0.46336892,   -0.71099734, -0.67903596, -0.7685777,  0.62395865};
  const int32_t input_0_ndim = 3;
  const int32_t input_0_dims[] = {3, 4, 5};
  const float input_1[] = {-0.030606998, 2.0843685, 0.28889206, 0.038466424,
                           -0.6808113};
  const int32_t input_1_ndim = 1;
  const int32_t input_1_dims[] = {5};
  float output_0[60];
  const int32_t output_0_ndim = 3;
  const int32_t output_0_dims[] = {3, 4, 5};
  const float answer_0[] = {
      -0.026380355, -2.127827,   0.20171866,   -0.039481726, 0.49772203,
      0.001140271,  -2.0940688,  -0.28312802,  0.00961903,   0.5562308,
      0.0075109587, -1.9798903,  -0.2619527,   0.002572821,  0.060912635,
      -0.035746306, -1.2959368,  -0.030318193, -0.012898221, -0.90751994,
      -0.03580006,  0.53231514,  -0.6475477,   -0.03719206,  -0.391286,
      0.009917544,  -1.8745655,  -0.29901806,  -0.05294113,  -0.5162443,
      -0.016202431, 2.2868776,   -0.069002286, 0.021275476,  -0.43260404,
      -0.008364052, -2.974494,   0.23485072,   -0.012310372, -0.15427275,
      -0.007962064, 2.1575968,   0.39514494,   -0.041484233, -0.79441524,
      -0.023512132, -3.3573015,  0.042870414,  -0.027094105, 0.15275857,
      -0.003148631, -0.83110553, -0.35516402,  -0.016295353, -1.5802737,
      -0.014182332, -1.4819804,  -0.1961681,   -0.029564435, -0.4247981};
  ONNC_RUNTIME_mul_float(NULL, (float *)input_0, input_0_ndim, input_0_dims,
                         (float *)input_1, input_1_ndim, input_1_dims,
                         (float *)output_0, output_0_ndim, output_0_dims);
  (dragonite::verify)(reinterpret_cast<float *>(output_0),
                      reinterpret_cast<const float *>(answer_0), 60);
}
