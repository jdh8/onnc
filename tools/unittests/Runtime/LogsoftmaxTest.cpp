#include "dragonite.hpp"
SKYPAT_F(Operator_LogSoftmax, test_logsoftmax_example_1) {
  const float input_0[] = {-1.0, 0.0, 1.0};
  const int32_t input_0_ndim = 2;
  const int32_t input_0_dims[] = {1, 3};
  float output_0[3];
  const int32_t output_0_ndim = 2;
  const int32_t output_0_dims[] = {1, 3};
  const float answer_0[] = {-2.407606, -1.4076059, -0.4076059};
  const int32_t axis = 0;
  ONNC_RUNTIME_logsoftmax_float(NULL, (float *)input_0, input_0_ndim,
                                input_0_dims, (float *)output_0, output_0_ndim,
                                output_0_dims, axis);
  (dragonite::verify)(reinterpret_cast<float *>(output_0),
                      reinterpret_cast<const float *>(answer_0), 3);
}

SKYPAT_F(Operator_LogSoftmax, test_logsoftmax_large_number) {
  const float input_0[] = {0.0,     1.0,     2.0,     3.0,
                           10000.0, 10001.0, 10002.0, 10003.0};
  const int32_t input_0_ndim = 2;
  const int32_t input_0_dims[] = {2, 4};
  float output_0[8];
  const int32_t output_0_ndim = 2;
  const int32_t output_0_dims[] = {2, 4};
  const float answer_0[] = {-3.4401896, -2.4401896, -1.4401897, -0.4401897,
                            -3.4401896, -2.4401896, -1.4401897, -0.4401897};
  const int32_t axis = 0;
  ONNC_RUNTIME_logsoftmax_float(NULL, (float *)input_0, input_0_ndim,
                                input_0_dims, (float *)output_0, output_0_ndim,
                                output_0_dims, axis);
  (dragonite::verify)(reinterpret_cast<float *>(output_0),
                      reinterpret_cast<const float *>(answer_0), 8);
}

SKYPAT_F(Operator_LogSoftmax, test_logsoftmax_axis_0) {
  const float input_0[] = {
      1.4464296,  0.7794259,    1.740791,    0.47440082, 0.94922274,
      1.2995738,  0.88053775,   1.0575298,   0.45943105, 0.5647519,
      0.09130954, 1.4983048,    1.1144285,   1.0590954,  0.6717851,
      0.3524451,  1.5513917,    0.684091,    2.2524343,  0.08684631,
      0.76265687, 0.0060065775, 0.7899547,   0.95521235, 0.30397376,
      2.2333634,  1.6884944,    0.04714689,  0.92350364, 0.75014204,
      0.6023541,  0.9117851,    0.4473812,   1.1450473,  0.09065631,
      0.9598983,  2.9037373,    0.021585304, 1.197055,   0.31670764,
      1.0902305,  0.9524816,    0.058141295, 0.5191739,  0.74220985,
      0.14566235, 1.0815219,    0.5242001,   0.31151146, 0.39368555,
      2.8277617,  0.4763644,    0.5875645,   0.43308082, 0.8908909,
      0.1484386,  1.4010588,    0.23097704,  1.0857009,  0.7842372};
  const int32_t input_0_ndim = 3;
  const int32_t input_0_dims[] = {3, 4, 5};
  float output_0[60];
  const int32_t output_0_ndim = 3;
  const int32_t output_0_dims[] = {3, 4, 5};
  const float answer_0[] = {
      -3.7586417, -4.425646,  -3.4642806, -4.730671,  -4.255849,  -3.9054976,
      -4.3245335, -4.1475415, -4.7456408, -4.64032,   -5.113762,  -3.7067666,
      -4.090643,  -4.145976,  -4.533286,  -4.8526263, -3.6536798, -4.520981,
      -2.9526372, -5.118225,  -4.4424143, -5.199065,  -4.415117,  -4.249859,
      -4.901098,  -2.971708,  -3.516577,  -5.1579247, -4.2815676, -4.4549294,
      -4.6027174, -4.2932863, -4.7576904, -4.0600243, -5.114415,  -4.2451735,
      -2.3013341, -5.183486,  -4.0080166, -4.888364,  -4.114841,  -4.2525897,
      -5.14693,   -4.685898,  -4.4628615, -5.059409,  -4.1235495, -4.680871,
      -4.89356,   -4.811386,  -2.3773098, -4.7287073, -4.617507,  -4.771991,
      -4.3141804, -5.056633,  -3.8040128, -4.9740944, -4.1193705, -4.4208345};
  const int32_t axis = 0;
  ONNC_RUNTIME_logsoftmax_float(NULL, (float *)input_0, input_0_ndim,
                                input_0_dims, (float *)output_0, output_0_ndim,
                                output_0_dims, axis);
  (dragonite::verify)(reinterpret_cast<float *>(output_0),
                      reinterpret_cast<const float *>(answer_0), 60);
}

SKYPAT_F(Operator_LogSoftmax, test_logsoftmax_axis_1) {
  const float input_0[] = {
      1.4464296,  0.7794259,    1.740791,    0.47440082, 0.94922274,
      1.2995738,  0.88053775,   1.0575298,   0.45943105, 0.5647519,
      0.09130954, 1.4983048,    1.1144285,   1.0590954,  0.6717851,
      0.3524451,  1.5513917,    0.684091,    2.2524343,  0.08684631,
      0.76265687, 0.0060065775, 0.7899547,   0.95521235, 0.30397376,
      2.2333634,  1.6884944,    0.04714689,  0.92350364, 0.75014204,
      0.6023541,  0.9117851,    0.4473812,   1.1450473,  0.09065631,
      0.9598983,  2.9037373,    0.021585304, 1.197055,   0.31670764,
      1.0902305,  0.9524816,    0.058141295, 0.5191739,  0.74220985,
      0.14566235, 1.0815219,    0.5242001,   0.31151146, 0.39368555,
      2.8277617,  0.4763644,    0.5875645,   0.43308082, 0.8908909,
      0.1484386,  1.4010588,    0.23097704,  1.0857009,  0.7842372};
  const int32_t input_0_ndim = 3;
  const int32_t input_0_dims[] = {3, 4, 5};
  float output_0[60];
  const int32_t output_0_ndim = 3;
  const int32_t output_0_dims[] = {3, 4, 5};
  const float answer_0[] = {
      -2.6612468, -3.3282504, -2.3668854, -3.6332755, -3.1584535, -2.8081026,
      -3.2271385, -3.0501466, -3.6482453, -3.5429244, -4.016367,  -2.6093717,
      -2.993248,  -3.0485811, -3.4358912, -3.7552314, -2.5562847, -3.4235854,
      -1.8552421, -4.02083,   -3.433179,  -4.1898293, -3.405881,  -3.2406235,
      -3.891862,  -1.9624723, -2.5073414, -4.148689,  -3.2723322, -3.4456935,
      -3.5934815, -3.2840505, -3.7484546, -3.0507884, -4.1051793, -3.2359376,
      -1.2920984, -4.1742506, -2.9987807, -3.879128,  -2.916729,  -3.0544777,
      -3.9488182, -3.4877856, -3.2647495, -3.8612971, -2.9254375, -3.4827595,
      -3.695448,  -3.6132739, -1.1791978, -3.530595,  -3.419395,  -3.5738785,
      -3.1160686, -3.8585207, -2.6059008, -3.7759824, -2.9212584, -3.2227223};
  const int32_t axis = 1;
  ONNC_RUNTIME_logsoftmax_float(NULL, (float *)input_0, input_0_ndim,
                                input_0_dims, (float *)output_0, output_0_ndim,
                                output_0_dims, axis);
  (dragonite::verify)(reinterpret_cast<float *>(output_0),
                      reinterpret_cast<const float *>(answer_0), 60);
}

SKYPAT_F(Operator_LogSoftmax, test_logsoftmax_default_axis) {
  const float input_0[] = {
      1.4464296,  0.7794259,    1.740791,    0.47440082, 0.94922274,
      1.2995738,  0.88053775,   1.0575298,   0.45943105, 0.5647519,
      0.09130954, 1.4983048,    1.1144285,   1.0590954,  0.6717851,
      0.3524451,  1.5513917,    0.684091,    2.2524343,  0.08684631,
      0.76265687, 0.0060065775, 0.7899547,   0.95521235, 0.30397376,
      2.2333634,  1.6884944,    0.04714689,  0.92350364, 0.75014204,
      0.6023541,  0.9117851,    0.4473812,   1.1450473,  0.09065631,
      0.9598983,  2.9037373,    0.021585304, 1.197055,   0.31670764,
      1.0902305,  0.9524816,    0.058141295, 0.5191739,  0.74220985,
      0.14566235, 1.0815219,    0.5242001,   0.31151146, 0.39368555,
      2.8277617,  0.4763644,    0.5875645,   0.43308082, 0.8908909,
      0.1484386,  1.4010588,    0.23097704,  1.0857009,  0.7842372};
  const int32_t input_0_ndim = 3;
  const int32_t input_0_dims[] = {3, 4, 5};
  float output_0[60];
  const int32_t output_0_ndim = 3;
  const int32_t output_0_dims[] = {3, 4, 5};
  const float answer_0[] = {
      -2.6612468, -3.3282504, -2.3668854, -3.6332755, -3.1584535, -2.8081026,
      -3.2271385, -3.0501466, -3.6482453, -3.5429244, -4.016367,  -2.6093717,
      -2.993248,  -3.0485811, -3.4358912, -3.7552314, -2.5562847, -3.4235854,
      -1.8552421, -4.02083,   -3.433179,  -4.1898293, -3.405881,  -3.2406235,
      -3.891862,  -1.9624723, -2.5073414, -4.148689,  -3.2723322, -3.4456935,
      -3.5934815, -3.2840505, -3.7484546, -3.0507884, -4.1051793, -3.2359376,
      -1.2920984, -4.1742506, -2.9987807, -3.879128,  -2.916729,  -3.0544777,
      -3.9488182, -3.4877856, -3.2647495, -3.8612971, -2.9254375, -3.4827595,
      -3.695448,  -3.6132739, -1.1791978, -3.530595,  -3.419395,  -3.5738785,
      -3.1160686, -3.8585207, -2.6059008, -3.7759824, -2.9212584, -3.2227223};
  const int32_t axis = 0;
  ONNC_RUNTIME_logsoftmax_float(NULL, (float *)input_0, input_0_ndim,
                                input_0_dims, (float *)output_0, output_0_ndim,
                                output_0_dims, axis);
  (dragonite::verify)(reinterpret_cast<float *>(output_0),
                      reinterpret_cast<const float *>(answer_0), 60);
}

SKYPAT_F(Operator_LogSoftmax, test_logsoftmax_axis_2) {
  const float input_0[] = {
      1.4464296,  0.7794259,    1.740791,    0.47440082, 0.94922274,
      1.2995738,  0.88053775,   1.0575298,   0.45943105, 0.5647519,
      0.09130954, 1.4983048,    1.1144285,   1.0590954,  0.6717851,
      0.3524451,  1.5513917,    0.684091,    2.2524343,  0.08684631,
      0.76265687, 0.0060065775, 0.7899547,   0.95521235, 0.30397376,
      2.2333634,  1.6884944,    0.04714689,  0.92350364, 0.75014204,
      0.6023541,  0.9117851,    0.4473812,   1.1450473,  0.09065631,
      0.9598983,  2.9037373,    0.021585304, 1.197055,   0.31670764,
      1.0902305,  0.9524816,    0.058141295, 0.5191739,  0.74220985,
      0.14566235, 1.0815219,    0.5242001,   0.31151146, 0.39368555,
      2.8277617,  0.4763644,    0.5875645,   0.43308082, 0.8908909,
      0.1484386,  1.4010588,    0.23097704,  1.0857009,  0.7842372};
  const int32_t input_0_ndim = 3;
  const int32_t input_0_dims[] = {3, 4, 5};
  float output_0[60];
  const int32_t output_0_ndim = 3;
  const int32_t output_0_dims[] = {3, 4, 5};
  const float answer_0[] = {
      -1.3460073,  -2.013011,  -1.051646,  -2.318036,  -1.8432143, -1.2101364,
      -1.6291724,  -1.4521804, -2.0502791, -1.9449582, -2.5083401, -1.1013448,
      -1.4852211,  -1.5405543, -1.9278646, -2.577368,  -1.3784213, -2.245722,
      -0.67737883, -2.8429668, -1.4681897, -2.22484,   -1.4408917, -1.2756342,
      -1.9268727,  -0.7834549, -1.3283238, -2.9696715, -2.0933146, -2.2666762,
      -1.7118499,  -1.402419,  -1.866823,  -1.1691568, -2.223548,  -2.3194478,
      -0.37560877, -3.2577608, -2.0822911, -2.9626384, -1.2523606, -1.3901094,
      -2.2844496,  -1.8234172, -1.6003811, -2.0110872, -1.0752277, -1.6325495,
      -1.8452382,  -1.763064,  -0.3625782, -2.7139754, -2.6027753, -2.757259,
      -2.299449,   -2.305287,  -1.0526667, -2.2227483, -1.3680246, -1.6694882};
  const int32_t axis = 2;
  ONNC_RUNTIME_logsoftmax_float(NULL, (float *)input_0, input_0_ndim,
                                input_0_dims, (float *)output_0, output_0_ndim,
                                output_0_dims, axis);
  (dragonite::verify)(reinterpret_cast<float *>(output_0),
                      reinterpret_cast<const float *>(answer_0), 60);
}
