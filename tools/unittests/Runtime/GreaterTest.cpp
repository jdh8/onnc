#if defined(__GNUC__) || defined(_MSC_VER)
#define restrict __restrict
#else
#define restrict
#endif

extern "C" {
#include <onnc/Runtime/onnc-runtime.h>
}

#undef restrict

#include "relative-error.hpp"
#include <skypat/skypat.h>
SKYPAT_F(Operator_Greater, test_greater) {
  const float input_0[] = {
      -0.5294334,  1.0578302,  0.95745444,  -0.42124987, -0.34182972,
      0.0588031,   0.8362219,  -0.8368593,  0.33329824,  -1.945222,
      -1.1090904,  0.42774624, -0.34228942, -0.34190172, 0.0772728,
      -1.347677,   0.52291286, -2.2545538,  -2.048228,   -0.7775267,
      0.48590738,  0.93520385, -0.27927828, 0.4752195,   -0.07052917,
      -0.36713782, 0.6053087,  -1.2540771,  -0.56938446, -0.08606659,
      -0.9918828,  2.7462113,  -0.50442004, -0.6184072,  -1.1105556,
      -1.9711922,  0.4838382,  1.1756206,   -1.2828865,  0.0043894546,
      0.6786595,   0.3436576,  -0.39355186, 1.373551,    1.1921797,
      1.3075275,   1.2054441,  -0.13151231, 0.22807457,  -1.0747943,
      0.7431993,   0.6639759,  0.3118328,   0.39585984,  -1.2966655,
      0.6350583,   0.9463907,  1.3329161,   0.6661261,   -0.9458684};
  const int32_t input_0_ndim = 3;
  const int32_t input_0_dims[] = {3, 4, 5};
  const float input_1[] = {
      -0.13053006, 0.09608231,  0.27291876,  0.015040386, 0.6278405,
      0.9685175,   0.86484706,  -0.6462426,  0.52362794,  0.38067645,
      0.20986971,  0.9385897,   -1.0961066,  -0.8628391,  1.25501,
      0.3334652,   2.2716358,   -2.1196554,  -0.6390725,  0.07022323,
      1.1856982,   -0.558439,   0.7876239,   0.72854215,  -0.10687774,
      0.9429553,   -0.14244562, -1.3991508,  0.9507888,   1.466628,
      -1.2241324,  -0.97105795, 0.59488046,  -0.63189554, 0.1508824,
      0.22548006,  0.48169518,  0.8021681,   0.24686608,  0.068801895,
      1.5647713,   1.2441276,   -0.9481466,  -0.5427247,  1.1240072,
      -1.2782494,  -0.6432642,  -1.4768394,  -0.47518617, -0.098896876,
      1.0564709,   0.2169088,   1.7003253,   -0.89348894, 2.5205986,
      0.25406435,  -0.13155925, -0.48290563, 0.3973149,   0.14111824};
  const int32_t input_1_ndim = 3;
  const int32_t input_1_dims[] = {3, 4, 5};
  float output_0[60];
  const int32_t output_0_ndim = 3;
  const int32_t output_0_dims[] = {3, 4, 5};
  const float answer_0[] = {0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                            0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
                            0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0,
                            1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0,
                            0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0,
                            0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 0.0};
  ONNC_RUNTIME_greater_float(nullptr, input_0, input_0_ndim, input_0_dims,
                             input_1, input_1_ndim, input_1_dims, output_0,
                             output_0_ndim, output_0_dims);
  ASSERT_TRUE(relative_error(output_0, answer_0, 60) < 1e-5f);
}

SKYPAT_F(Operator_Greater, test_greater_bcast) {
  const float input_0[] = {
      -1.6133738,  -1.1066101,  -0.860615,   -0.1975869,   0.07349835,
      0.7592658,   0.78586674,  -0.35246277, 0.6083432,    -0.5568141,
      0.48363405,  -0.9124063,  -1.5855526,  0.2575476,    0.77343047,
      1.1839132,   -0.03388281, -1.7977937,  0.9932492,    -1.3307135,
      -0.26815236, 0.52639776,  0.35736024,  -0.118155524, -0.85635793,
      -0.24063605, 1.3670374,   -0.65384716, -0.58494264,  -1.9049853,
      0.017656583, -0.61776876, -0.7132711,  1.159414,     -1.274257,
      -0.529594,   -1.5216303,  1.2238938,   0.8293284,    -0.18526475,
      1.0317638,   0.32055083,  1.4424948,   -0.56228286,  1.4294245,
      0.13990204,  1.0621045,   0.009939795, 0.94642884,   -1.3434103,
      0.94955313,  -0.20833409, 0.5874371,   -0.4378307,   0.2637609,
      0.21621314,  0.8659798,   -0.20000443, -0.13790892,  -1.5854099E-05};
  const int32_t input_0_ndim = 3;
  const int32_t input_0_dims[] = {3, 4, 5};
  const float input_1[] = {-1.0384017, -0.26019955, -0.118547976, 2.438351,
                           -1.2787135};
  const int32_t input_1_ndim = 1;
  const int32_t input_1_dims[] = {5};
  float output_0[60];
  const int32_t output_0_ndim = 3;
  const int32_t output_0_dims[] = {3, 4, 5};
  const float answer_0[] = {0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 1.0,
                            1.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0,
                            1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0,
                            1.0, 0.0, 0.0, 0.0, 1.0, 1.0, 0.0, 1.0, 0.0, 1.0,
                            1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0,
                            1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 1.0};
  ONNC_RUNTIME_greater_float(nullptr, input_0, input_0_ndim, input_0_dims,
                             input_1, input_1_ndim, input_1_dims, output_0,
                             output_0_ndim, output_0_dims);
  ASSERT_TRUE(relative_error(output_0, answer_0, 60) < 1e-5f);
}
