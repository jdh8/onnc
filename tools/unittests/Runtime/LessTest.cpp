#if defined(__GNUC__) || defined(_MSC_VER)
#define restrict __restrict
#else
#define restrict
#endif

extern "C" {
#include <onnc/Runtime/onnc-runtime.h>
}

#undef restrict

#include "relative-error.hpp"
#include <skypat/skypat.h>
SKYPAT_F(Operator_Less, test_less) {
  const float input_0[] = {
      0.21492378,  -1.1613421,  0.7550445,    -0.043448623, 0.12536508,
      1.7399032,   -0.75763273, -0.025569722, 0.34872407,   -0.29994467,
      0.13657519,  -1.5698171,  0.30180383,   -1.6387876,   -0.3446878,
      0.42109892,  -0.5017039,  -0.069935404, -1.3547356,   -1.103834,
      0.30015972,  -0.16381629, 0.37452045,   -0.25394255,  1.0997475,
      -1.3890777,  -0.3160721,  0.26455122,   -0.32000792,  0.3234239,
      0.830896,    0.6765267,   -0.17843305,  0.34415564,   -1.548645,
      1.6983923,   1.1532291,   0.7077209,    0.44218385,   -0.65482277,
      -0.61089855, -0.21219851, -0.27910757,  0.0131197255, -0.39402267,
      1.4827918,   2.721546,    0.59856844,   -1.922453,    0.3125712,
      0.8149828,   0.11801931,  -0.2278249,   -1.3366822,   -0.73968875,
      -0.50281245, 0.7420727,   0.13579696,   -1.1707555,   0.76916873};
  const int32_t input_0_ndim = 3;
  const int32_t input_0_dims[] = {3, 4, 5};
  const float input_1[] = {
      -0.39213446, 0.3889139,   -0.09456096, -0.9875976,  0.35233924,
      -0.17362173, -1.7121606,  0.020066695, 1.5951276,   -0.06697553,
      -0.32766315, 1.0032595,   -0.06738115, -1.1346407,  -0.92643446,
      0.4626116,   0.20346142,  0.042371586, 1.5306313,   1.8027251,
      -0.6814938,  0.96872234,  -0.3271476,  1.7057981,   0.97838455,
      1.2366941,   -0.6435991,  0.24230132,  0.85732484,  2.0200808,
      1.4873704,   0.7655522,   1.5226558,   -0.32773614, 1.9845948,
      1.4739561,   0.37182313,  0.531445,    -0.19349994, 1.7843546,
      -0.13964471, -0.78600913, -0.44497204, -0.18242764, -1.3191909,
      -0.483564,   0.29286188,  0.056417428, -1.8160454,  0.11406636,
      -0.32730287, -1.3198777,  -0.2296488,  -0.67861956, -0.44571647,
      2.5836554,   0.4192132,   -0.5724362,  -0.15605181, -0.32242143};
  const int32_t input_1_ndim = 3;
  const int32_t input_1_dims[] = {3, 4, 5};
  float output_0[60];
  const int32_t output_0_ndim = 3;
  const int32_t output_0_dims[] = {3, 4, 5};
  const float answer_0[] = {0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0, 1.0,
                            0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0,
                            0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 1.0,
                            1.0, 1.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0,
                            1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0,
                            0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 1.0, 0.0};
  ONNC_RUNTIME_less_float(nullptr, input_0, input_0_ndim, input_0_dims, input_1,
                          input_1_ndim, input_1_dims, output_0, output_0_ndim,
                          output_0_dims);
  ASSERT_TRUE(relative_error(output_0, answer_0, 60) < 1e-5f);
}

SKYPAT_F(Operator_Less, test_less_bcast) {
  const float input_0[] = {
      0.84329975,  -1.6405149,  0.5499941,    1.0377908,    0.40225673,
      0.50917435,  -1.0879298,  -0.18837439,  1.0813152,    -0.46719775,
      -0.08322667, 1.7638848,   -1.9070141,   1.9002004,    -0.4736904,
      1.1431922,   0.22892806,  -1.1444105,   0.82414824,   -0.4187747,
      -0.40333152, -1.0680463,  -1.3796046,   0.07421395,   -0.6199843,
      -0.39659894, 1.3691838,   -0.14998607,  -0.14013684,  -0.027420089,
      1.2898268,   0.80282396,  -0.25794843,  -1.7986826,   0.6433416,
      0.3313714,   0.20299901,  -0.073459856, 0.62899476,   1.2247018,
      1.5363414,   -1.04014,    0.81965333,   1.1389837,    0.22358194,
      -0.33114532, -1.7260017,  0.2670471,    -0.077748805, -2.0858874,
      -0.80537325, 0.737061,    -0.79668,     0.97043306,   0.23448883,
      0.83939576,  -0.88319063, -0.40480217,  -1.5679027,   -1.0494016};
  const int32_t input_0_ndim = 3;
  const int32_t input_0_dims[] = {3, 4, 5};
  const float input_1[] = {-1.4384636, 0.30962726, 0.7723004, 0.9522433,
                           0.40532577};
  const int32_t input_1_ndim = 1;
  const int32_t input_1_dims[] = {5};
  float output_0[60];
  const int32_t output_0_ndim = 3;
  const int32_t output_0_dims[] = {3, 4, 5};
  const float answer_0[] = {0.0, 1.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0,
                            0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0,
                            0.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 1.0,
                            0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0,
                            0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0,
                            0.0, 0.0, 1.0, 0.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0};
  ONNC_RUNTIME_less_float(nullptr, input_0, input_0_ndim, input_0_dims, input_1,
                          input_1_ndim, input_1_dims, output_0, output_0_ndim,
                          output_0_dims);
  ASSERT_TRUE(relative_error(output_0, answer_0, 60) < 1e-5f);
}
