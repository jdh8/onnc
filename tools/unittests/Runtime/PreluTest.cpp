#include "dragonite.hpp"
SKYPAT_F(Operator_PRelu, test_prelu_example) {
  const float input_0[] = {
      -0.7724047,   -0.3168138,  0.7011417,   -1.2204349,  0.7157711,
      -1.477692,    0.061658844, 0.7330226,   -0.27675012, 0.43968284,
      -0.42119977,  -1.1300036,  -0.85166305, 0.10241827,  -0.0332662,
      0.49390215,   -0.9610542,  0.3764308,   -1.0616552,  0.32186198,
      0.043285646,  0.5154783,   0.37970474,  -1.0932369,  0.08999589,
      -1.0244473,   1.669247,    -0.08430937, 0.49662054,  1.548723,
      0.036689326,  0.56282896,  0.23669799,  -0.8776537,  -0.325996,
      -0.006400643, 0.6013839,   -1.0896522,  1.2084454,   -1.2394502,
      -0.02424335,  1.7484924,   0.15055943,  0.41990846,  0.51278806,
      -0.14572166,  0.84269744,  -0.6336064,  0.019423831, -0.97042525,
      -0.47523746,  1.9580158,   -1.0054786,  -0.19254331, 0.7212068,
      0.98019445,   1.6434757,   -2.1675332,  -0.3846522,  -0.054112308};
  const int32_t input_0_ndim = 3;
  const int32_t input_0_dims[] = {3, 4, 5};
  const float input_1[] = {
      -0.1652091,  -1.65769,    -0.41989952, 0.24396114,   1.2760886,
      -0.2179239,  0.6096986,   1.5420289,   -1.0598708,   0.400614,
      0.17331362,  -0.35062498, 1.9585489,   -0.09972232,  0.13427787,
      0.9714647,   2.7657375,   1.1914818,   1.979359,     -0.14251086,
      -0.39192206, 1.8871127,   -1.1327046,  0.14767995,   0.581676,
      0.2266661,   -0.8287056,  -0.84594345, -0.39905992,  0.7701739,
      0.7828344,   0.72594875,  -0.5798419,  0.6307763,    0.23630579,
      1.3194355,   1.4323872,   -0.42324692, -0.107128315, -0.58700025,
      0.39911282,  -1.0650494,  1.7133794,   -0.028381085, -2.6755736,
      0.3438679,   -1.914807,   -0.6373481,  -2.238116,    0.13071825,
      0.30137366,  -0.42818657, -1.0848565,  0.6131272,    0.80506414,
      -0.37750557, -1.6795485,  0.6155802,   -0.16439135,  -1.294802};
  const int32_t input_1_ndim = 3;
  const int32_t input_1_dims[] = {3, 4, 5};
  float output_0[60];
  const int32_t output_0_ndim = 3;
  const int32_t output_0_dims[] = {3, 4, 5};
  const float answer_0[] = {
      0.12760828,    0.5251791,   0.7011417,  -0.2977387,  0.7157711,
      0.3220244,     0.061658844, 0.7330226,  0.29331937,  0.43968284,
      -0.072999656,  0.39620748,  -1.6680237, 0.10241827,  -0.0044669146,
      0.49390215,    -2.6580236,  0.3764308,  -2.1013968,  0.32186198,
      0.043285646,   0.5154783,   0.37970474, -0.16144918, 0.08999589,
      -0.23220748,   1.669247,    0.07132096, 0.49662054,  1.548723,
      0.036689326,   0.56282896,  0.23669799, -0.5536032,  -0.07703474,
      -0.008445235,  0.6013839,   0.46119192, 1.2084454,   0.7275576,
      -0.0096758315, 1.7484924,   0.15055943, 0.41990846,  0.51278806,
      -0.050109,     0.84269744,  0.40382782, 0.019423831, -0.12685229,
      -0.14322405,   1.9580158,   1.0908,     -0.11805354, 0.7212068,
      0.98019445,    1.6434757,   -1.3342905, 0.063233495, 0.07006472};
  ONNC_RUNTIME_prelu_float(NULL, (float *)input_0, input_0_ndim, input_0_dims,
                           (float *)input_1, input_1_ndim, input_1_dims,
                           (float *)output_0, output_0_ndim, output_0_dims);
  (dragonite::verify)(reinterpret_cast<float *>(output_0),
                      reinterpret_cast<const float *>(answer_0), 60);
}

SKYPAT_F(Operator_PRelu, test_prelu_broadcast) {
  const float input_0[] = {
      0.120413505, -0.7887391,   -0.4261403,  -1.8250953,  -1.0041435,
      -0.41664505, -0.018555924, 0.9787538,   -4.2320404,  1.3037468,
      0.8327896,   -0.53972465,  -0.23916475, 0.5605292,   -0.8541973,
      -0.2421459,  0.46095046,   -0.5861122,  0.60471916,  -0.5673059,
      1.1756408,   -0.27101862,  1.1097205,   0.6305527,   1.0633005,
      0.17480887,  -0.75442356,  -1.5380125,  -0.6983551,  1.7689981,
      -0.48965803, 1.286524,     0.14412723,  -0.20851335, 0.79297596,
      1.468327,    0.78484875,   1.4804201,   -0.48192492, 1.5987605,
      0.3028816,   -0.0992531,   -0.8636786,  0.5763395,   0.614389,
      0.103508174, 0.8557392,    0.77444446,  1.0161202,   1.5611421,
      -0.4025814,  -0.58725816,  0.92513824,  1.1618311,   -1.1883081,
      -1.4261372,  0.45857587,   0.9721177,   -1.0395441,  -0.8836467};
  const int32_t input_0_ndim = 3;
  const int32_t input_0_dims[] = {3, 4, 5};
  const float input_1[] = {-0.61085784, -1.451696, -1.3856076, 0.13665454,
                           -0.45276767};
  const int32_t input_1_ndim = 1;
  const int32_t input_1_dims[] = {5};
  float output_0[60];
  const int32_t output_0_ndim = 3;
  const int32_t output_0_dims[] = {3, 4, 5};
  const float answer_0[] = {
      0.120413505, 1.1450094,   0.5904632,  -0.24940756,  0.4546437,
      0.2545109,   0.026937561, 0.9787538,  -0.57832754,  1.3037468,
      0.8327896,   0.7835161,   0.3313885,  0.5605292,    0.38675293,
      0.14791672,  0.46095046,  0.8121215,  0.60471916,   0.25685778,
      1.1756408,   0.39343667,  1.1097205,  0.6305527,    1.0633005,
      0.17480887,  1.0951937,   2.1310818,  -0.09543339,  1.7689981,
      0.29911146,  1.286524,    0.14412723, -0.028494297, 0.79297596,
      1.468327,    0.78484875,  1.4804201,  -0.06585723,  1.5987605,
      0.3028816,   0.14408533,  1.1967196,  0.5763395,    0.614389,
      0.103508174, 0.8557392,   0.77444446, 1.0161202,    1.5611421,
      0.24592,     0.85252035,  0.92513824, 1.1618311,    0.5380275,
      0.8711671,   0.45857587,  0.9721177,  -0.14205842,  0.40008667};
  ONNC_RUNTIME_prelu_float(NULL, (float *)input_0, input_0_ndim, input_0_dims,
                           (float *)input_1, input_1_ndim, input_1_dims,
                           (float *)output_0, output_0_ndim, output_0_dims);
  (dragonite::verify)(reinterpret_cast<float *>(output_0),
                      reinterpret_cast<const float *>(answer_0), 60);
}
