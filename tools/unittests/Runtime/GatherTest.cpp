#include "dragonite.hpp"
SKYPAT_F(Operator_Gather, test_gather_0) {
  const float input_0[] = {
      -0.040572386, -0.20771815,  1.9300575,   1.0798624,   -1.3199745,
      -0.23797494,  1.7198913,    0.17398639,  -0.41084966, -1.1361275,
      -1.0407977,   -1.1915928,   -1.5696855,  -1.3657956,  -0.12927392,
      1.2464774,    -0.786256,    0.09573645,  0.36978027,  0.5552487,
      2.334381,     -1.2403849,   0.4928095,   -0.9542696,  0.8814695,
      0.67304605,   0.0087049585, -0.4659763,  -1.3029197,  0.10591747,
      -0.56044286,  0.46443704,   -0.03464176, 1.523791,    0.43683302,
      -0.030443087, 0.84313697,   0.46557695,  1.4963961,   0.1561952,
      0.9551096,    1.3082964,    0.06190986,  0.017373415, -0.36741894,
      -1.1183501,   0.5227272,    -0.17232643, 0.70309466,  1.0636926,
      0.79536295,   0.78128076,   -1.0929674,  0.91662306,  -0.25075698,
      -0.84090096,  -0.7408446,   -0.40083125, 0.6397115,   0.5219561,
      -0.4743258,   -0.19839017,  -0.20626287, -0.59682804, -0.2725249,
      -0.74481726,  -0.10700494,  -0.44169426, 0.49959823,  -0.26780015,
      -0.9665359,   0.66959345,   1.4450285,   -1.4939687,  1.2171727,
      0.21991688,   -1.497681,    -1.0184709,  -1.289201,   -0.21535304,
      0.91582614,   0.20712322,   0.79425526,  0.39555645,  -0.94364685,
      -0.07396946,  -1.1555963,   0.6079887,   0.005471256, -0.5106351,
      -0.77344346,  -0.56480175,  0.36665636,  -0.40442336, -0.17532526,
      1.2310303,    0.48147714,   1.6831087,   1.6864126,   -0.14676224,
      2.2666929,    0.84526026,   0.13866064,  -0.2633794,  -2.031821,
      0.042295847,  -0.7305371,   0.9198195,   -0.4470751,  0.78816193,
      -0.53838927,  0.35628417,   2.0638149,   -0.2228275,  0.78390765,
      -0.19725311,  0.96613145,   0.36164933,  0.8106232,   -0.55674404};
  const int32_t input_0_ndim = 4;
  const int32_t input_0_dims[] = {5, 4, 3, 2};
  const float input_1[] = {0, 1, 3};
  const int32_t input_1_ndim = 1;
  const int32_t input_1_dims[] = {3};
  float output_0[72];
  const int32_t output_0_ndim = 4;
  const int32_t output_0_dims[] = {3, 4, 3, 2};
  const float answer_0[] = {
      -0.040572386, -0.20771815,  1.9300575,   1.0798624,   -1.3199745,
      -0.23797494,  1.7198913,    0.17398639,  -0.41084966, -1.1361275,
      -1.0407977,   -1.1915928,   -1.5696855,  -1.3657956,  -0.12927392,
      1.2464774,    -0.786256,    0.09573645,  0.36978027,  0.5552487,
      2.334381,     -1.2403849,   0.4928095,   -0.9542696,  0.8814695,
      0.67304605,   0.0087049585, -0.4659763,  -1.3029197,  0.10591747,
      -0.56044286,  0.46443704,   -0.03464176, 1.523791,    0.43683302,
      -0.030443087, 0.84313697,   0.46557695,  1.4963961,   0.1561952,
      0.9551096,    1.3082964,    0.06190986,  0.017373415, -0.36741894,
      -1.1183501,   0.5227272,    -0.17232643, 1.4450285,   -1.4939687,
      1.2171727,    0.21991688,   -1.497681,   -1.0184709,  -1.289201,
      -0.21535304,  0.91582614,   0.20712322,  0.79425526,  0.39555645,
      -0.94364685,  -0.07396946,  -1.1555963,  0.6079887,   0.005471256,
      -0.5106351,   -0.77344346,  -0.56480175, 0.36665636,  -0.40442336,
      -0.17532526,  1.2310303};
  const int32_t axis = 0;
  ONNC_RUNTIME_gather_float(NULL, (float *)input_0, input_0_ndim, input_0_dims,
                            (float *)input_1, input_1_ndim, input_1_dims,
                            (float *)output_0, output_0_ndim, output_0_dims,
                            axis);
  (dragonite::verify)(reinterpret_cast<float *>(output_0),
                      reinterpret_cast<const float *>(answer_0), 72);
}

SKYPAT_F(Operator_Gather, test_gather_1) {
  const float input_0[] = {
      1.0681707,   -0.5512006,   -0.9681427,  0.3360494,    1.4684714,
      -0.40119094, 1.60142,      0.06129848,  -0.73391825,  -0.52878445,
      1.3775542,   -0.19712126,  -1.8024552,  0.28014356,   0.09561593,
      0.31446278,  1.9871202,    -0.24086007, 0.09905641,   0.22581352,
      1.5484908,   0.4140611,    0.5658777,   -0.21206489,  0.5181452,
      -0.89910346, -0.39140996,  -0.43434525, 0.7172011,    -0.5591003,
      1.2749884,   1.336282,     1.4871074,   0.17311305,   0.68429524,
      1.4073178,   1.5560656,    -0.76922935, -0.1682533,   0.2549078,
      1.574539,    0.15615581,   1.4041511,   -0.7464713,   -0.5876031,
      -0.2160244,  1.2129924,    2.1789079,   -0.711451,    -1.923042,
      -0.10545132, -0.042657122, 1.0347304,   -0.022715699, 1.257961,
      0.3335724,   -2.7655857,   -0.2738866,  1.8791794,    0.53990227,
      -0.8775122,  0.20683433,   -0.09708026, 1.4279524,    1.2551237,
      0.9872884,   0.53486764,   -0.82699335, 0.78959614,   0.82155395,
      -0.1774842,  0.06471652,   -0.27558598, -0.46597674,  -0.13632564,
      -0.5483396,  -0.49791384,  -0.66717273, -1.1691962,   -0.6931551,
      0.44734636,  -0.28475824,  -1.2419555,  -0.71144366,  -0.5036189,
      -1.5482078,  -2.3068566,   1.4435102,   0.18367124,   1.767968,
      0.8643248,   1.4989135,    -0.53717077, -0.29750162,  0.17658849,
      0.4387993,   0.78534627,   -2.9775236,  -0.9542771,   -0.7339516,
      0.012031357, 0.9703883,    0.7026281,   0.24459928,   -0.91895986,
      -1.0766243,  1.1062762,    1.7899648,   -0.20780724,  -1.3176258,
      -0.68534976, -1.1880699,   -1.0484022,  -1.319026,    -0.14679226,
      -0.75086033, -0.3060426,   -0.08885034, 0.27744624,   -0.023563912};
  const int32_t input_0_ndim = 4;
  const int32_t input_0_dims[] = {5, 4, 3, 2};
  const float input_1[] = {0, 1, 3};
  const int32_t input_1_ndim = 1;
  const int32_t input_1_dims[] = {3};
  float output_0[90];
  const int32_t output_0_ndim = 4;
  const int32_t output_0_dims[] = {5, 3, 3, 2};
  const float answer_0[] = {
      1.0681707,   -0.5512006,   -0.9681427,  0.3360494,   1.4684714,
      -0.40119094, 1.60142,      0.06129848,  -0.73391825, -0.52878445,
      1.3775542,   -0.19712126,  0.09905641,  0.22581352,  1.5484908,
      0.4140611,   0.5658777,    -0.21206489, 0.5181452,   -0.89910346,
      -0.39140996, -0.43434525,  0.7172011,   -0.5591003,  1.2749884,
      1.336282,    1.4871074,    0.17311305,  0.68429524,  1.4073178,
      1.4041511,   -0.7464713,   -0.5876031,  -0.2160244,  1.2129924,
      2.1789079,   -0.711451,    -1.923042,   -0.10545132, -0.042657122,
      1.0347304,   -0.022715699, 1.257961,    0.3335724,   -2.7655857,
      -0.2738866,  1.8791794,    0.53990227,  0.53486764,  -0.82699335,
      0.78959614,  0.82155395,   -0.1774842,  0.06471652,  -0.27558598,
      -0.46597674, -0.13632564,  -0.5483396,  -0.49791384, -0.66717273,
      -1.1691962,  -0.6931551,   0.44734636,  -0.28475824, -1.2419555,
      -0.71144366, 0.8643248,    1.4989135,   -0.53717077, -0.29750162,
      0.17658849,  0.4387993,    0.78534627,  -2.9775236,  -0.9542771,
      -0.7339516,  0.012031357,  0.9703883,   0.7026281,   0.24459928,
      -0.91895986, -1.0766243,   1.1062762,   1.7899648,   -0.14679226,
      -0.75086033, -0.3060426,   -0.08885034, 0.27744624,  -0.023563912};
  const int32_t axis = 1;
  ONNC_RUNTIME_gather_float(NULL, (float *)input_0, input_0_ndim, input_0_dims,
                            (float *)input_1, input_1_ndim, input_1_dims,
                            (float *)output_0, output_0_ndim, output_0_dims,
                            axis);
  (dragonite::verify)(reinterpret_cast<float *>(output_0),
                      reinterpret_cast<const float *>(answer_0), 90);
}
