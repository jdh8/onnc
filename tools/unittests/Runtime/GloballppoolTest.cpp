#if defined(__GNUC__) || defined(_MSC_VER)
#  define restrict __restrict
#else
#  define restrict
#endif

extern "C" {
#include <onnc/Runtime/onnc-runtime.h>
}

#undef restrict

#include "norm.hpp"
#include <skypat/skypat.h>
SKYPAT_F(Operator_GlobalLpPool, l2norm)
{
  const float input_0[] = {
    0.414293,    -1.1529808,  2.416922,     -0.41077122, -0.32400915, -0.0023106248, -1.298052,   0.16302009,
    0.827027,    0.595074,    -1.2020116,   -0.41351524, -0.56540567, 0.76072437,    0.86790293,  -1.296372,
    -0.06050484, -2.6237993,  0.70584434,   1.4622408,   0.54952055,  -1.1123457,    -1.383167,   -0.71220374,
    0.071132176, -2.3935683,  -0.5279521,   1.5760758,   0.41706824,  -0.39790213,   -0.68973714, -1.2858318,
    -0.16990094, -1.1131715,  0.936046,     0.98895115,  -0.2889631,  1.3393048,     0.22859684,  1.1970861,
    0.5197254,   -0.531992,   -0.8754691,   1.1879876,   1.2059474,   -0.54663295,   0.220253,    -0.7183634,
    1.8384229,   -1.4258085,  1.2753671,    1.0305108,   -0.88342535, -1.5701663,    -1.3470592,  -1.042709,
    -0.96478283, -0.24904314, 2.8196816,    -1.5234939,  0.13022153,  0.3392989,     -0.42409638, 1.6091648,
    -1.566308,   -0.5434695,  1.4244277,    1.2430451,   2.4124124,   0.09326964,    0.64759904,  0.008932123,
    1.384996,    0.6201006,   -0.058980804, 0.8955232,   -1.1024356,  -0.2857908,    -1.6238776,  0.15704717,
    -0.34312347, -1.3108919,  0.2891263,    1.3451902,   -0.8970082,  0.86169636,    -1.5483626,  0.4548753,
    -1.9690616,  1.928588,    -0.22303763,  0.96448785,  -1.905035,   0.5317221,     0.15988863,  -0.6255365,
    -0.14198266, -0.18675648, -0.013892839, -1.3121554,  -0.26009727, -1.0610723,    -0.99540806, -1.6993824,
    1.9012893,   -0.9386842,  0.6418294,    0.44136584,  -0.33009085, 0.24303511,    -0.82774174, -0.042586282,
    0.64639556,  1.1560696,   -2.196434,    -0.21991415, -0.15513924, 0.32190138,    0.032363422, 0.6219793};
  const int32_t input_0_ndim   = 5;
  const int32_t input_0_dims[] = {1, 2, 3, 4, 5};
  float         output_0[2];
  const int32_t output_0_ndim   = 5;
  const int32_t output_0_dims[] = {1, 2, 1, 1, 1};
  const float   answer_0[]      = {8.763729, 7.9545426};
  const int32_t p               = 2;
  using dragonite::norm;

  ONNC_RUNTIME_globallppool_float(nullptr, input_0, input_0_ndim, input_0_dims, output_0, output_0_ndim, output_0_dims,
                                  p);
  ASSERT_TRUE(norm(answer_0, output_0, 2) <= 1e-5 * norm(answer_0, 2));
}

SKYPAT_F(Operator_GlobalLpPool, l3norm)
{
  const float input_0[] = {
    -1.2249372,   0.75518864,   -1.2002894,   0.23111732,  -0.85279846, 0.48065618,  0.589825,    -0.19934769,
    0.5912944,    0.6785434,    0.60735583,   -0.7123863,  0.1848963,   -0.7021977,  -0.49989754, -1.3101451,
    0.14128159,   -0.010414772, 0.0075246864, 0.29432496,  -1.366995,   -1.1346847,  0.5833714,   0.6056678,
    0.20914447,   1.3943378,    0.54192495,   0.6399828,   -0.6197903,  0.934379,    -1.8002578,  -0.9843263,
    0.01093178,   -0.15728344,  -1.328284,    -0.8757533,  1.4111531,   0.4532685,   -0.19861624, 0.4709468,
    -2.2037284,   -0.45834646,  0.26317915,   -0.35636458, -1.243218,   -0.45225304, 0.25690195,  -0.69370246,
    0.20639789,   -0.69620323,  -1.952546,    -0.23255022, 0.17407195,  0.23475234,  -0.9288984,  -1.7540356,
    -0.48346907,  -1.0678276,   0.26314428,   -1.3471565,  -1.2587969,  1.671743,    0.7911563,   -0.3826412,
    -0.015617858, 1.8481302,    0.38416228,   -0.46983728, -1.194804,   1.6982954,   -0.6324387,  0.8490623,
    -0.20787731,  -1.3182657,   0.8491981,    0.18124552,  0.06809704,  -1.0866646,  2.678419,    -1.4863133,
    -0.42295438,  -0.6788641,   -0.46516728,  1.056726,    1.5280161,   -0.81621367, -0.723004,   0.20700799,
    0.65892565,   -0.4774627,   0.26497582,   0.8160232,   1.6285666,   -0.6816913,  1.0995845,   0.5471987,
    0.45587298,   -0.28091773,  0.84861016,   -0.21716888, -0.56068265, -1.3558984,  1.0060186,   0.13280976,
    -1.9249686,   -0.20887059,  1.1743265,    0.54136866,  1.5733628,   -2.4264712,  -0.4664346,  -0.69676787,
    -0.05504378,  -0.6305624,   1.1734828,    -0.22050773, -0.17012163, 1.875647,    -0.7409916,  -0.57308316};
  const int32_t input_0_ndim   = 5;
  const int32_t input_0_dims[] = {1, 2, 3, 4, 5};
  float         output_0[2];
  const int32_t output_0_ndim   = 5;
  const int32_t output_0_dims[] = {1, 2, 1, 1, 1};
  const float   answer_0[]      = {3.9431024, 4.6747518};
  const int32_t p               = 3;
  using dragonite::norm;

  ONNC_RUNTIME_globallppool_float(nullptr, input_0, input_0_ndim, input_0_dims, output_0, output_0_ndim, output_0_dims,
                                  p);
  ASSERT_TRUE(norm(answer_0, output_0, 2) <= 1e-5 * norm(answer_0, 2));
}

SKYPAT_F(Operator_GlobalLpPool, l1norm)
{
  const float input_0[] = {
    1.4305402,    0.50062466,  -1.7036955,  1.1642325,   1.9342507,    -0.7555652,   0.06261138,  1.6510509,
    -1.5863961,   1.303932,    -0.3254484,  0.391725,    -0.7902149,   0.5687722,    -0.7654201,  -1.4662274,
    0.63128316,   0.6058582,   0.08178231,  -2.4653332,  1.1046497,    -1.0081888,   -0.9057129,  0.19400896,
    -0.14309491,  -1.1253678,  -0.86714923, -0.7941331,  -0.3492042,   0.8584673,    1.0589451,   0.47493267,
    -0.08762918,  -0.5438811,  0.16178457,  -1.216336,   0.85839224,   -0.65102494,  1.2667073,   1.4051074,
    -1.9322358,   -1.0212244,  0.06717486,  -1.0285721,  0.31220663,   -0.9090248,   -1.1544845,  -1.2342247,
    -0.50903827,  0.20443833,  -0.3661098,  -0.49324146, 0.80541736,   -2.1013525,   -0.13354875, 0.6935216,
    0.16449559,   -0.6000065,  -0.56596386, 0.84517896,  -0.49873367,  0.21868667,   -0.20154512, 0.58314574,
    -0.030678572, -0.13321878, -0.6077002,  -0.43833733, -0.41147915,  -1.4678477,   -0.48310244, -1.3351324,
    -2.142691,    -0.4148698,  1.6746335,   -0.15594915, -0.24916445,  -0.93595755,  -0.33222294, 0.08603366,
    -0.10405519,  0.30323067,  -0.37561825, 0.019958135, 0.70227575,   0.0071160416, 1.5734268,   0.13662094,
    1.0981152,    -0.9311924,  -0.20262063, -0.42523956, -0.015232901, -0.118445545, -0.1625245,  -0.56775385,
    1.7836666,    0.8601566,   0.15567847,  -0.9458685,  0.24807605,   -1.5538796,   0.91111076,  -0.36166602,
    0.51403344,   0.046584558, -0.64560425, -1.781911,   1.4800518,    0.11063295,   -0.27985084, 1.8349721,
    -0.85209876,  1.7782612,   2.6033213,   0.37017208,  0.45482147,   0.9622563,    0.7132899,   -1.2324841};
  const int32_t input_0_ndim   = 5;
  const int32_t input_0_dims[] = {1, 2, 3, 4, 5};
  float         output_0[2];
  const int32_t output_0_ndim   = 5;
  const int32_t output_0_dims[] = {1, 2, 1, 1, 1};
  const float   answer_0[]      = {50.401134, 41.62501};
  const int32_t p               = 1;
  using dragonite::norm;

  ONNC_RUNTIME_globallppool_float(nullptr, input_0, input_0_ndim, input_0_dims, output_0, output_0_ndim, output_0_dims,
                                  p);
  ASSERT_TRUE(norm(answer_0, output_0, 2) <= 1e-5 * norm(answer_0, 2));
}
