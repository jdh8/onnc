#if defined(__GNUC__) || defined(_MSC_VER)
#  define restrict __restrict
#else
#  define restrict
#endif

extern "C" {
#include <onnc/Runtime/onnc-runtime.h>
}

#undef restrict

#include "norm.hpp"
#include <skypat/skypat.h>
SKYPAT_F(Operator_Abs, test_abs)
{
  const float input_0[] = {
    0.96973866,  0.44189286,  0.5172941,  -0.72432244, 0.21420106,  0.62708926,    0.964015,   2.1921937,   -1.0063568,
    0.6044914,   0.19144547,  0.14810805, -1.0503038,  -1.6758842,  -0.0049659107, -1.4092525, -0.18911119, -0.5436942,
    -1.0449953,  0.5796062,   0.82714903, 0.24273196,  0.72862804,  -0.24305044,   -0.6592005, 1.3639948,   -1.1397036,
    -0.58651,    0.24251752,  -0.7121392, -1.0312277,  1.019513,    2.0038962,     1.2836573,  -0.38164625, -0.8417133,
    1.7851928,   0.033445533, -0.3627085, 0.4303301,   -0.27775148, -0.13526177,   0.6300373,  -0.74154544, -1.057223,
    -1.6789728,  -1.2934241,  0.3712142,  -1.3130875,  -0.0590817,  0.55738276,    0.363185,   0.87401,     1.5946634,
    -0.19938739, 0.20297533,  -0.7823003, 0.14136809,  -0.32926008, 0.44459367};
  const int32_t input_0_ndim   = 3;
  const int32_t input_0_dims[] = {3, 4, 5};
  float         output_0[60];
  const int32_t output_0_ndim   = 3;
  const int32_t output_0_dims[] = {3, 4, 5};
  const float   answer_0[]      = {
    0.96973866, 0.44189286,  0.5172941,  0.72432244, 0.21420106, 0.62708926,   0.964015,  2.1921937,  1.0063568,
    0.6044914,  0.19144547,  0.14810805, 1.0503038,  1.6758842,  0.0049659107, 1.4092525, 0.18911119, 0.5436942,
    1.0449953,  0.5796062,   0.82714903, 0.24273196, 0.72862804, 0.24305044,   0.6592005, 1.3639948,  1.1397036,
    0.58651,    0.24251752,  0.7121392,  1.0312277,  1.019513,   2.0038962,    1.2836573, 0.38164625, 0.8417133,
    1.7851928,  0.033445533, 0.3627085,  0.4303301,  0.27775148, 0.13526177,   0.6300373, 0.74154544, 1.057223,
    1.6789728,  1.2934241,   0.3712142,  1.3130875,  0.0590817,  0.55738276,   0.363185,  0.87401,    1.5946634,
    0.19938739, 0.20297533,  0.7823003,  0.14136809, 0.32926008, 0.44459367};
  using dragonite::norm;

  ONNC_RUNTIME_abs_float(nullptr, input_0, input_0_ndim, input_0_dims, output_0, output_0_ndim, output_0_dims);
  ASSERT_TRUE(norm(answer_0, output_0, 60) <= 1e-5 * norm(answer_0, 60));
}
