#include <cmath>
#include <cstdlib>
#include <ctime>
#include <skypat/skypat.h>
#include <vector>

#define restrict
extern "C" {
#include <onnc/Runtime/onnc-runtime.h>
}
SKYPAT_F(Operator_Abs, test_abs) {
  const float input_0[3][4][5] = {
      {{0.6206427812576294, -1.619997262954712, -0.22012856602668762,
        -0.12552355229854584, 0.8258956670761108},
       {-0.42110320925712585, 1.3012582063674927, 0.20198561251163483,
        -1.0216768980026245, 1.3363780975341797},
       {0.2958773076534271, 0.7161709666252136, 0.37252533435821533,
        2.047978162765503, 1.1896800994873047},
       {-0.2837197184562683, -0.5474721193313599, 0.17786648869514465,
        -0.13059896230697632, 1.1575309038162231}},
      {{0.03743324428796768, -0.02763923816382885, -0.2658473253250122,
        -0.2532011866569519, -0.22789156436920166},
       {-0.37947943806648254, 0.178021639585495, 0.6562814712524414,
        -0.8427345156669617, -1.1541364192962646},
       {1.0307408571243286, -0.8358359932899475, 0.2616218030452728,
        -1.4662076234817505, 0.2985791265964508},
       {0.5815917253494263, -1.8734489679336548, -1.3485337495803833,
        0.9833424687385559, -0.0857870951294899}},
      {{-0.684468686580658, -1.0176180601119995, -1.2383532524108887,
        -0.35889771580696106, -1.1350752115249634},
       {0.44037923216819763, -1.6746361255645752, -1.1551700830459595,
        -0.9626399278640747, 0.3060528635978699},
       {-0.7345656752586365, -1.4127967357635498, -1.7493698596954346,
        -1.1102347373962402, 1.4121063947677612},
       {1.718339204788208, 2.1510202884674072, -0.8243073225021362,
        -0.5420079231262207, 0.6560822129249573}}};
  const int32_t input_0_ndim = 3;
  const int32_t input_0_dims[] = {3, 4, 5};
  float output_0[3][4][5];
  const int32_t output_0_ndim = 3;
  const int32_t output_0_dims[] = {3, 4, 5};
  const float answer_0[3][4][5] = {
      {{0.6206427812576294, 1.619997262954712, 0.22012856602668762,
        0.12552355229854584, 0.8258956670761108},
       {0.42110320925712585, 1.3012582063674927, 0.20198561251163483,
        1.0216768980026245, 1.3363780975341797},
       {0.2958773076534271, 0.7161709666252136, 0.37252533435821533,
        2.047978162765503, 1.1896800994873047},
       {0.2837197184562683, 0.5474721193313599, 0.17786648869514465,
        0.13059896230697632, 1.1575309038162231}},
      {{0.03743324428796768, 0.02763923816382885, 0.2658473253250122,
        0.2532011866569519, 0.22789156436920166},
       {0.37947943806648254, 0.178021639585495, 0.6562814712524414,
        0.8427345156669617, 1.1541364192962646},
       {1.0307408571243286, 0.8358359932899475, 0.2616218030452728,
        1.4662076234817505, 0.2985791265964508},
       {0.5815917253494263, 1.8734489679336548, 1.3485337495803833,
        0.9833424687385559, 0.0857870951294899}},
      {{0.684468686580658, 1.0176180601119995, 1.2383532524108887,
        0.35889771580696106, 1.1350752115249634},
       {0.44037923216819763, 1.6746361255645752, 1.1551700830459595,
        0.9626399278640747, 0.3060528635978699},
       {0.7345656752586365, 1.4127967357635498, 1.7493698596954346,
        1.1102347373962402, 1.4121063947677612},
       {1.718339204788208, 2.1510202884674072, 0.8243073225021362,
        0.5420079231262207, 0.6560822129249573}}};
  ONNC_RUNTIME_abs_float(NULL, (float *)input_0, input_0_ndim, input_0_dims,
                         (float *)output_0, output_0_ndim, output_0_dims);
  bool is_correct;
  is_correct = true;
  for (int32_t i = 0; i < 3 * 4 * 5; ++i) {
    if (abs(((float *)output_0)[i] - ((float *)answer_0)[i]) > 1.0e-7) {
      is_correct = false;
      break;
    }
  }
  ASSERT_TRUE(is_correct);
}
